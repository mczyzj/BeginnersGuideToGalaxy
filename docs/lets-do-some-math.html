<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Beginners Guide to R’s Galaxy</title>
  <meta name="description" content="Quick introduction to astonishing R’s Galaxy">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="A Beginners Guide to R’s Galaxy" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Quick introduction to astonishing R’s Galaxy" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Beginners Guide to R’s Galaxy" />
  
  <meta name="twitter:description" content="Quick introduction to astonishing R’s Galaxy" />
  

<meta name="author" content="Michal J. Czyz">


<meta name="date" content="2018-05-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="somwehere-between-basic-and-useful.html">
<link rel="next" href="finalindications.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Beginners Guide to Galaxy</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> In the beginning there was only darknes…</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#audience"><i class="fa fa-check"></i><b>2.1</b> Audience</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#what-this-book-is-not-about"><i class="fa fa-check"></i><b>2.2</b> What this book is not about?</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#few-tips-to-make-life-easier"><i class="fa fa-check"></i><b>2.4</b> Few tips to make life easier</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#installing-packages"><i class="fa fa-check"></i><b>2.5</b> Installing packages</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#conventions"><i class="fa fa-check"></i><b>2.6</b> Conventions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>3</b> Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="basics.html"><a href="basics.html#getting-started"><i class="fa fa-check"></i><b>3.1</b> Getting started</a><ul>
<li class="chapter" data-level="3.1.1" data-path="basics.html"><a href="basics.html#help"><i class="fa fa-check"></i><b>3.1.1</b> Help</a></li>
<li class="chapter" data-level="3.1.2" data-path="basics.html"><a href="basics.html#internet-is-a-great-source-of-information"><i class="fa fa-check"></i><b>3.1.2</b> Internet is a great source of information</a></li>
<li class="chapter" data-level="3.1.3" data-path="basics.html"><a href="basics.html#more-on-internet-sources"><i class="fa fa-check"></i><b>3.1.3</b> More on internet sources</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basics.html"><a href="basics.html#syntax"><i class="fa fa-check"></i><b>3.2</b> Syntax</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basics.html"><a href="basics.html#common-operators"><i class="fa fa-check"></i><b>3.2.1</b> Common operators</a></li>
<li class="chapter" data-level="3.2.2" data-path="basics.html"><a href="basics.html#variables"><i class="fa fa-check"></i><b>3.2.2</b> Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics.html"><a href="basics.html#math-operations"><i class="fa fa-check"></i><b>3.3</b> Math operations</a></li>
<li class="chapter" data-level="3.4" data-path="basics.html"><a href="basics.html#logics"><i class="fa fa-check"></i><b>3.4</b> Logics</a></li>
<li class="chapter" data-level="3.5" data-path="basics.html"><a href="basics.html#functions"><i class="fa fa-check"></i><b>3.5</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html"><i class="fa fa-check"></i><b>4</b> Somwehere between basic and useful</a><ul>
<li class="chapter" data-level="4.1" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#addressing"><i class="fa fa-check"></i><b>4.1</b> Addressing</a><ul>
<li class="chapter" data-level="4.1.1" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#vectors"><i class="fa fa-check"></i><b>4.1.1</b> Vectors</a></li>
<li class="chapter" data-level="4.1.2" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#data-frames-and-matrices"><i class="fa fa-check"></i><b>4.1.2</b> Data frames (and matrices)</a></li>
<li class="chapter" data-level="4.1.3" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#lists"><i class="fa fa-check"></i><b>4.1.3</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#control-flow"><i class="fa fa-check"></i><b>4.2</b> Control flow</a><ul>
<li class="chapter" data-level="4.2.1" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#if...else-and-ifelse-statments"><i class="fa fa-check"></i><b>4.2.1</b> <code>if...else</code> and <code>ifelse</code> statments</a></li>
<li class="chapter" data-level="4.2.2" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#for-and-while-loops"><i class="fa fa-check"></i><b>4.2.2</b> <code>for</code> and <code>while</code> loops</a></li>
<li class="chapter" data-level="4.2.3" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#apply-function-family"><i class="fa fa-check"></i><b>4.2.3</b> <code>apply</code> function family</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#operation-on-vectors"><i class="fa fa-check"></i><b>4.3</b> Operation on Vectors</a></li>
<li class="chapter" data-level="4.4" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#randomization-and-distribution"><i class="fa fa-check"></i><b>4.4</b> Randomization and distribution</a></li>
<li class="chapter" data-level="4.5" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#tidyverse-idea-and-dplyr-library"><i class="fa fa-check"></i><b>4.5</b> <code>tidyverse</code> idea and <code>dplyr</code> library</a><ul>
<li class="chapter" data-level="4.5.1" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#wide-vs.long-tables"><i class="fa fa-check"></i><b>4.5.1</b> Wide vs. long tables</a></li>
<li class="chapter" data-level="4.5.2" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#world-of-dplyr"><i class="fa fa-check"></i><b>4.5.2</b> World of <code>dplyr</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#select-columns-and-filter-rows"><i class="fa fa-check"></i><b>4.5.3</b> <code>select</code> columns and <code>filter</code> rows</a></li>
<li class="chapter" data-level="4.5.4" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#mutate-and-transmute"><i class="fa fa-check"></i><b>4.5.4</b> <code>mutate</code> and <code>transmute</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#group_by-and-summarise"><i class="fa fa-check"></i><b>4.5.5</b> <code>group_by</code> and <code>summarise</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#is-there-anything-more-in-dplyr-library"><i class="fa fa-check"></i><b>4.6</b> Is there anything more in <code>dplyr</code> library?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html"><i class="fa fa-check"></i><b>5</b> Lets do some math!</a><ul>
<li class="chapter" data-level="5.1" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#models"><i class="fa fa-check"></i><b>5.1</b> Models</a></li>
<li class="chapter" data-level="5.2" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#packages"><i class="fa fa-check"></i><b>5.2</b> Packages</a></li>
<li class="chapter" data-level="5.3" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#simple-mechanistic-model-and-noise"><i class="fa fa-check"></i><b>5.3</b> Simple mechanistic model and noise</a></li>
<li class="chapter" data-level="5.4" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#solving-differential-equations"><i class="fa fa-check"></i><b>5.4</b> Solving differential equations</a><ul>
<li class="chapter" data-level="5.4.1" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#the-simple-epidemiological"><i class="fa fa-check"></i><b>5.4.1</b> The simple epidemiological</a></li>
<li class="chapter" data-level="5.4.2" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#ploting-seri-model"><i class="fa fa-check"></i><b>5.4.2</b> Ploting SERI model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="finalindications.html"><a href="finalindications.html"><i class="fa fa-check"></i><b>6</b> Functions</a><ul>
<li class="chapter" data-level="6.1" data-path="finalindications.html"><a href="finalindications.html#simple-math-functions."><i class="fa fa-check"></i><b>6.1</b> Simple math functions.</a></li>
<li class="chapter" data-level="6.2" data-path="finalindications.html"><a href="finalindications.html#building-your-own-calculator"><i class="fa fa-check"></i><b>6.2</b> Building your own calculator</a></li>
<li class="chapter" data-level="6.3" data-path="finalindications.html"><a href="finalindications.html#it-is-not-over-yet-calculator-shouldnt-divide-be-0"><i class="fa fa-check"></i><b>6.3</b> It is not over yet… <em>Calculator shouldn’t divide be 0</em>!</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>7</b> Graphics</a><ul>
<li class="chapter" data-level="7.1" data-path="graphs.html"><a href="graphs.html#base-plots"><i class="fa fa-check"></i><b>7.1</b> Base plots</a></li>
<li class="chapter" data-level="7.2" data-path="graphs.html"><a href="graphs.html#how-to-make-plot"><i class="fa fa-check"></i><b>7.2</b> How to make plot?</a></li>
<li class="chapter" data-level="7.3" data-path="graphs.html"><a href="graphs.html#can-we-actually-do-something"><i class="fa fa-check"></i><b>7.3</b> Can we actually do something?</a></li>
<li class="chapter" data-level="7.4" data-path="graphs.html"><a href="graphs.html#ggplot2---graphics-taken-into-other-dimension"><i class="fa fa-check"></i><b>7.4</b> <code>ggplot2</code> - Graphics taken into other dimension</a><ul>
<li class="chapter" data-level="7.4.1" data-path="graphs.html"><a href="graphs.html#basic-plot-in-ggplot2"><i class="fa fa-check"></i><b>7.4.1</b> Basic plot in <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.4.2" data-path="graphs.html"><a href="graphs.html#density-plots"><i class="fa fa-check"></i><b>7.4.2</b> Density plots</a></li>
<li class="chapter" data-level="7.4.3" data-path="graphs.html"><a href="graphs.html#box-plot-and-bar-plot"><i class="fa fa-check"></i><b>7.4.3</b> Box-plot and bar-plot</a></li>
<li class="chapter" data-level="7.4.4" data-path="graphs.html"><a href="graphs.html#regression"><i class="fa fa-check"></i><b>7.4.4</b> Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simple-workflow.html"><a href="simple-workflow.html"><i class="fa fa-check"></i><b>8</b> Simple workflow</a><ul>
<li class="chapter" data-level="8.1" data-path="simple-workflow.html"><a href="simple-workflow.html#data"><i class="fa fa-check"></i><b>8.1</b> Data</a></li>
<li class="chapter" data-level="8.2" data-path="simple-workflow.html"><a href="simple-workflow.html#exploaratory-visualisation-and-setup"><i class="fa fa-check"></i><b>8.2</b> Exploaratory visualisation and setup</a></li>
<li class="chapter" data-level="8.3" data-path="simple-workflow.html"><a href="simple-workflow.html#growth-models"><i class="fa fa-check"></i><b>8.3</b> Growth models</a></li>
<li class="chapter" data-level="8.4" data-path="simple-workflow.html"><a href="simple-workflow.html#going-further"><i class="fa fa-check"></i><b>8.4</b> Going further</a></li>
<li class="chapter" data-level="8.5" data-path="simple-workflow.html"><a href="simple-workflow.html#copy-paste-data-set"><i class="fa fa-check"></i><b>8.5</b> Copy-paste data set</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="finalind.html"><a href="finalind.html"><i class="fa fa-check"></i><b>9</b> Final indications</a><ul>
<li class="chapter" data-level="9.1" data-path="finalind.html"><a href="finalind.html#use-projects"><i class="fa fa-check"></i><b>9.1</b> Use Projects</a></li>
<li class="chapter" data-level="9.2" data-path="finalind.html"><a href="finalind.html#use-rmarkdown"><i class="fa fa-check"></i><b>9.2</b> Use RMarkdown</a></li>
<li class="chapter" data-level="9.3" data-path="finalind.html"><a href="finalind.html#use-.rds-files"><i class="fa fa-check"></i><b>9.3</b> Use .rds files</a></li>
<li class="chapter" data-level="9.4" data-path="finalind.html"><a href="finalind.html#nice-resources-you-should-read"><i class="fa fa-check"></i><b>9.4</b> Nice resources you SHOULD read</a></li>
<li class="chapter" data-level="9.5" data-path="finalind.html"><a href="finalind.html#solving-problems"><i class="fa fa-check"></i><b>9.5</b> Solving problems</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Beginners Guide to R’s Galaxy</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lets-do-some-math" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Lets do some math!</h1>
<div id="models" class="section level2">
<h2><span class="header-section-number">5.1</span> Models</h2>
<hr />

<hr />
<p>OK. There is no such thing as simple statistical model. However there are lots of packages that will make you suffer less. In fact this is one of biggest <strong>R</strong> advantages, that you can make even very sophisticated statistical modelling without any knowledge on programming since you use <em>black boxes</em>. When you are dealing with classic statistical models many of them are included in <strong>base R</strong> distribution – like linear or generalized additive models. You probably need to use mixed effect models, at some point. Good news is that there is a very nice and quite straightforward to use package called <code>lme4</code>. Every time you run into problem, and you do not know what to use for statistical modelling, or how to perform full procedure, just query Google. There are hundreds of blogs, web pages and <em>Stack Overflow</em> discussion on it.</p>
<hr />

<hr />
<p>Besides <em>simple statistical models</em>, there is a lot of other models. The scope of this book is not to discuss dichotomies in classification of models. To keep things simple, we will just stick to <em>models</em> that can be described with at least one of the following adjectives: <em>stochastic</em>, <em>mechanistic</em> or belong to <em>differential equations systems</em>.</p>
</div>
<div id="packages" class="section level2">
<h2><span class="header-section-number">5.2</span> Packages</h2>
<p>Other, usually dynamic models, require more knowledge, experience and some packages. Before you start looking for more tailored solutions, install following packages: <code>deSolve</code>, <code>fitdistrplus</code>, <code>rriskDistributions</code> and <code>truncdist</code>. First one contains tools for solving differential equations sets, second and third provides you tools to deal with distributions (such as comparing distributions or estimating its parameters), and the last one allows you to use truncated distributions.</p>
</div>
<div id="simple-mechanistic-model-and-noise" class="section level2">
<h2><span class="header-section-number">5.3</span> Simple mechanistic model and noise</h2>
<p>To show some basic mechanistic model, we will use the well known Michaelis-Menten function: <span class="math inline">\(f(x) = \frac{ax}{b+x}\)</span>, with <em>parameter a = 2.15</em> and <em>parameter b = 0.08</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">parA &lt;-<span class="st"> </span><span class="fl">2.15</span>
parB &lt;-<span class="st"> </span><span class="fl">0.08</span>
varX &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>)
mmFunction &lt;-<span class="st"> </span>parA <span class="op">*</span><span class="st"> </span>varX<span class="op">/</span>(parB <span class="op">+</span><span class="st"> </span>varX)
<span class="kw">plot</span>(mmFunction<span class="op">~</span>varX, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</code></pre></div>
<div class="figure"><span id="fig:MMfunction"></span>
<img src="BeginnersGuideToGalaxy_files/figure-html/MMfunction-1.png" alt="Simple Michaelis-Menten function" width="672" />
<p class="caption">
Figure 5.1: Simple Michaelis-Menten function
</p>
</div>
<p>As you can see, as long as you have simple equation it is very straightforward to translate it into R. But we want something more useful, for instance adding noise or uncertainty to our model. Lets assume, that we are not sure what is the value of <em>parameter a</em>. Lets say that from previous research and expert knowledge we assume that it can be as high 2.5, but never is lower than 1.8. Also it usually takes value of 2.15. Knowing this we can use PERT distribution to include uncertainty in model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;mc2d&#39;</span>)
sParA &lt;-<span class="st"> </span><span class="kw">rpert</span>(<span class="dv">1000</span>, <span class="fl">1.8</span>, <span class="fl">2.15</span>, <span class="fl">2.5</span>)
parB &lt;-<span class="st"> </span><span class="fl">0.08</span>
mmSAFunction &lt;-<span class="st"> </span>sParA <span class="op">*</span><span class="st"> </span>varX<span class="op">/</span>(parB <span class="op">+</span><span class="st"> </span>varX)</code></pre></div>
<p>We added some uncertainty to our function. But what with <em>parameter b</em>, how our uncertainty on its value affects the outcome? Lets assume that it’s value is normally distributed with <em>mean = 0.8</em> and <em>sd = 0.23</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sParB &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="fl">0.08</span>, <span class="fl">0.023</span>) 
mmSABFunction &lt;-<span class="st"> </span>sParA <span class="op">*</span><span class="st"> </span>varX<span class="op">/</span>(sParB <span class="op">+</span><span class="st"> </span>varX)</code></pre></div>
<p>Let me put this two functions on plots side by side:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(mmSAFunction<span class="op">~</span>varX, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)
<span class="kw">plot</span>(mmSABFunction<span class="op">~</span>varX, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<div class="figure"><span id="fig:MMfunctionAB"></span>
<img src="BeginnersGuideToGalaxy_files/figure-html/MMfunctionAB-1.png" alt="Michaelis-Menten function with stochastic parameter A (left) or A and B (right)" width="672" />
<p class="caption">
Figure 5.2: Michaelis-Menten function with stochastic parameter A (left) or A and B (right)
</p>
</div>
<p>It seems that inclusion of uncertainty on value of <em>parameter b</em> does change our outcome. Lets also include some variability into the outcome. We can assume that for some reasons value of function will vary more than just our uncertainty about value of both <em>parameters</em>. And usually it varies from <span class="math inline">\(f(x)\)</span> by some value from uniform distribution. The 25<sup>th</sup> and 75<sup>th</sup> percentile are given by: <code>-0.13</code> and <code>0.17</code>. To calculate parameters of this distribution we will use <code>rriskDistributions</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rriskDistributions&#39;</span>)
unifParams &lt;-<span class="st"> </span><span class="kw">get.unif.par</span>(<span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="dt">q =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.13</span>, <span class="fl">0.17</span>), <span class="dt">plot =</span> F)
fVariability &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>, <span class="dt">min =</span> unifParams[<span class="dv">1</span>], <span class="dt">max =</span> unifParams[<span class="dv">2</span>])
mmFSFunction &lt;-<span class="st"> </span>((sParA <span class="op">*</span><span class="st"> </span>varX<span class="op">/</span>(sParB <span class="op">+</span><span class="st"> </span>varX)) <span class="op">+</span><span class="st"> </span>fVariability)
<span class="kw">plot</span>(mmFSFunction<span class="op">~</span>varX, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-44"></span>
<img src="BeginnersGuideToGalaxy_files/figure-html/unnamed-chunk-44-1.png" alt="Michaelis-Menten function fully stochastic" width="672" />
<p class="caption">
Figure 5.3: Michaelis-Menten function fully stochastic
</p>
</div>
<p>It seems that there are differences between those three plots. So lets overlay them one on another to inspect visually differences.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(varX, mmFunction, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>,
     <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>),
     <span class="dt">main =</span> <span class="st">&#39;Michaelis-Menten function&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;x&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;f(x) = a*x/(b+x)&#39;</span>)
<span class="kw">lines</span>(varX, mmSAFunction, <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>)
<span class="kw">lines</span>(varX, mmSABFunction, <span class="dt">col =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">lty =</span> <span class="st">&#39;dashed&#39;</span>)
<span class="kw">lines</span>(varX, mmFSFunction, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">lty =</span> <span class="st">&#39;dotted&#39;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-45"></span>
<img src="BeginnersGuideToGalaxy_files/figure-html/unnamed-chunk-45-1.png" alt="Michaelis-Menten function with different levels of stochasticity" width="672" />
<p class="caption">
Figure 5.4: Michaelis-Menten function with different levels of stochasticity
</p>
</div>
</div>
<div id="solving-differential-equations" class="section level2">
<h2><span class="header-section-number">5.4</span> Solving differential equations</h2>
<div id="the-simple-epidemiological" class="section level3">
<h3><span class="header-section-number">5.4.1</span> The simple epidemiological</h3>
<p>SIR (Susceptible, Infectious, Recovered) is a typical compartmental model for epidemiology. Since it has only 3 compartments, it is hard to find an easier one to model with differential equations. In our example we will use slightly more complicated example with four compartments – SEIR (Susceptible, Exposed, Infectious, Recovered). We begin with defining parameters of initial population. We need to define: birth and death rate, transmission (<span class="math inline">\(\beta\)</span>), <span class="math inline">\(\gamma\)</span> (<span class="math inline">\(\frac{1}{\gamma}\)</span> defines infectious period) and <span class="math inline">\(\alpha\)</span> (<span class="math inline">\(\frac{1}{\alpha}\)</span> defines latent period). Than we define time and initial conditions – number of all specimens, population size, number of exposed, number of initially infected, number of initially recovered, which we combine in <code>initial</code> values vector.<br />
Main step of this procedure is to define function which will be used to solve <em>Ordinary Differential Equations (ODE)</em>. This function takes three parameter – t (which is time sequence), state (which are our initial conditions) and parameters. In the body of the function we define differential equations which connect our compartments. To solve the system of differential equations we use <code>ode()</code> function from <code>deSolve</code> package and save our results in <code>modelOutput</code> variable, which we will later use to make a plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">parameters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">b     =</span> <span class="fl">0.1</span>,        <span class="co"># birth rate</span>
                <span class="dt">d     =</span> <span class="fl">0.1</span>,        <span class="co"># death rate</span>
                <span class="dt">beta  =</span> <span class="fl">0.00025</span>,    <span class="co"># transmission parameter</span>
                <span class="dt">gamma =</span> <span class="fl">0.6</span>,        <span class="co"># 1/gamma = infectious period</span>
                <span class="dt">a     =</span> <span class="fl">0.1</span>        <span class="co"># 1/a = latent period</span>
                )

time &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>

<span class="co"># Initial conditions</span>
N =<span class="st"> </span><span class="dv">15000</span>    <span class="co"># population size</span>
E0 =<span class="st"> </span><span class="dv">150</span>     <span class="co"># initialy exposed</span>
I0 =<span class="st"> </span><span class="dv">15</span>      <span class="co"># initialy infected</span>
R0 =<span class="st"> </span><span class="dv">20</span>      <span class="co"># initialy recovered</span>

initial &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">S =</span> N <span class="op">-</span><span class="st"> </span>(E0 <span class="op">+</span><span class="st"> </span>I0 <span class="op">+</span><span class="st"> </span>R0), <span class="dt">E =</span> E0, <span class="dt">I=</span> I0, <span class="dt">R =</span> R0)

<span class="co"># ODE Model</span>
fSEIR &lt;-<span class="st"> </span><span class="cf">function</span>(t, state, parameters) {
  <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">c</span>(state, parameters)), {
    dS =<span class="st"> </span>b <span class="op">*</span><span class="st"> </span>(S <span class="op">+</span><span class="st"> </span>E <span class="op">+</span><span class="st"> </span>I <span class="op">+</span><span class="st"> </span>R) <span class="op">-</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>d <span class="op">*</span><span class="st"> </span>S
    dE =<span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>a <span class="op">*</span><span class="st"> </span>E <span class="op">-</span><span class="st"> </span>d <span class="op">*</span><span class="st"> </span>E
    dI =<span class="st"> </span>a <span class="op">*</span><span class="st"> </span>E <span class="op">-</span><span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>d <span class="op">*</span><span class="st"> </span>I
    dR =<span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>d <span class="op">*</span><span class="st"> </span>R
    <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">c</span>(dS, dE, dI, dR)))
  })
}

modelOutput &lt;-<span class="st"> </span>deSolve<span class="op">::</span><span class="kw">ode</span>(<span class="dt">y =</span> initial, <span class="dt">func =</span> fSEIR, <span class="dt">times =</span> time, <span class="dt">parms =</span> parameters)
<span class="kw">head</span>(modelOutput)</code></pre></div>
<pre><code>##      time        S        E        I        R
## [1,]    1 14815.00 150.0000 15.00000 20.00000
## [2,]    2 14771.93 180.7236 19.41006 27.94129
## [3,]    3 14717.22 220.8724 24.19132 37.72072
## [4,]    4 14649.90 270.7314 29.83648 49.53296
## [5,]    5 14567.85 331.7169 36.66138 63.77320
## [6,]    6 14468.27 405.8173 44.94943 80.96618</code></pre>
</div>
<div id="ploting-seri-model" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Ploting SERI model</h3>
<p>To create a plot using our favorite library <code>ggplot2</code> (which will be described with more details in chapter <a href="graphs.html#graphs">7</a>) we first need to convert our modelOutput to object of class <em>data frame</em>. Than we can use code below to plot our model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelOutput &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(modelOutput)
<span class="kw">ggplot</span>(modelOutput, <span class="kw">aes</span>(<span class="dt">x =</span> time)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> S, <span class="dt">colour =</span> <span class="st">&quot;S&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> E, <span class="dt">colour =</span> <span class="st">&quot;E&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> I, <span class="dt">colour =</span> <span class="st">&quot;I&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> R, <span class="dt">colour =</span> <span class="st">&quot;R&quot;</span>))</code></pre></div>
<p><img src="BeginnersGuideToGalaxy_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>However, the element <code>geom_line</code> is repeated four times, which does not look nice. We can change it with little effort, and also define some better aesthetics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelOutput &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(modelOutput) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> compartment, <span class="dt">value =</span> value, <span class="op">-</span>time) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(<span class="kw">data.frame</span>(<span class="dt">compartment =</span> <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;R&quot;</span>),
                       <span class="dt">ordered =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,
                       <span class="dt">stringsAsFactors =</span> F), <span class="dt">by =</span> <span class="st">&#39;compartment&#39;</span>)
<span class="kw">ggplot</span>(modelOutput, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> value,
                        <span class="dt">colour =</span> <span class="kw">reorder</span>(compartment, ordered))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span>viridis<span class="op">::</span><span class="kw">scale_colour_viridis</span>(<span class="dt">discrete =</span> T) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;#dfdfdf&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Compartment&#39;</span>,
       <span class="dt">x =</span> <span class="st">&#39;Time&#39;</span>,
       <span class="dt">y =</span> <span class="st">&#39;Population size&#39;</span>,
       <span class="dt">title =</span> <span class="st">&#39;SERI epidemiological model&#39;</span>)</code></pre></div>
<p><img src="BeginnersGuideToGalaxy_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>You might wonder why we added additional column to <code>modelOutput</code> data frame. The thing is that <code>ggplot</code> automatically maps some aesthetics to groups using alphabetical order. Created column in which we store numbers that refer to compartment order in <em>SERI</em> acronym. Than we use it as argument to <code>reorder</code> function inside <code>ggplot</code>, which under the hood transforms variable to <em>factor</em> and change <em>level</em> orders. Using this approach, we don’t need to change all the orderings of variables and aesthetics manually. I also used color palette from *<code>viridis</code> package, which contains four nice looking color palettes, which are colorblind safe (at least in theory).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="somwehere-between-basic-and-useful.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="finalindications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["BeginnersGuideToGalaxy.pdf", "BeginnersGuideToGalaxy.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
