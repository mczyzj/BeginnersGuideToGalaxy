<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Beginners Guide to R’s Galaxy</title>
  <meta name="description" content="Quick introduction to astonishing R’s Galaxy">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="A Beginners Guide to R’s Galaxy" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Quick introduction to astonishing R’s Galaxy" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Beginners Guide to R’s Galaxy" />
  
  <meta name="twitter:description" content="Quick introduction to astonishing R’s Galaxy" />
  

<meta name="author" content="Michal J. Czyz">


<meta name="date" content="2018-05-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="basics.html">
<link rel="next" href="lets-do-some-math.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Beginners Guide to Galaxy</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> In the beginning there was only darkness…</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#audience"><i class="fa fa-check"></i><b>2.1</b> Audience</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#what-this-book-is-not-about"><i class="fa fa-check"></i><b>2.2</b> What this book is not about?</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#few-tips-to-make-life-easier"><i class="fa fa-check"></i><b>2.4</b> Few tips to make life easier</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#installing-packages"><i class="fa fa-check"></i><b>2.5</b> Installing packages</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#conventions"><i class="fa fa-check"></i><b>2.6</b> Conventions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>3</b> Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="basics.html"><a href="basics.html#getting-started"><i class="fa fa-check"></i><b>3.1</b> Getting started</a><ul>
<li class="chapter" data-level="3.1.1" data-path="basics.html"><a href="basics.html#help"><i class="fa fa-check"></i><b>3.1.1</b> Help</a></li>
<li class="chapter" data-level="3.1.2" data-path="basics.html"><a href="basics.html#internet-is-a-great-source-of-information"><i class="fa fa-check"></i><b>3.1.2</b> Internet is a great source of information</a></li>
<li class="chapter" data-level="3.1.3" data-path="basics.html"><a href="basics.html#more-on-internet-sources"><i class="fa fa-check"></i><b>3.1.3</b> More on internet sources</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basics.html"><a href="basics.html#syntax"><i class="fa fa-check"></i><b>3.2</b> Syntax</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basics.html"><a href="basics.html#common-operators"><i class="fa fa-check"></i><b>3.2.1</b> Common operators</a></li>
<li class="chapter" data-level="3.2.2" data-path="basics.html"><a href="basics.html#variables"><i class="fa fa-check"></i><b>3.2.2</b> Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basics.html"><a href="basics.html#math-operations"><i class="fa fa-check"></i><b>3.3</b> Math operations</a></li>
<li class="chapter" data-level="3.4" data-path="basics.html"><a href="basics.html#logics"><i class="fa fa-check"></i><b>3.4</b> Logics</a></li>
<li class="chapter" data-level="3.5" data-path="basics.html"><a href="basics.html#functions"><i class="fa fa-check"></i><b>3.5</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html"><i class="fa fa-check"></i><b>4</b> Somwehere between basic and useful</a><ul>
<li class="chapter" data-level="4.1" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#addressing"><i class="fa fa-check"></i><b>4.1</b> Addressing</a><ul>
<li class="chapter" data-level="4.1.1" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#vectors"><i class="fa fa-check"></i><b>4.1.1</b> Vectors</a></li>
<li class="chapter" data-level="4.1.2" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#data-frames-and-matrices"><i class="fa fa-check"></i><b>4.1.2</b> Data frames (and matrices)</a></li>
<li class="chapter" data-level="4.1.3" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#lists"><i class="fa fa-check"></i><b>4.1.3</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#control-flow"><i class="fa fa-check"></i><b>4.2</b> Control flow</a><ul>
<li class="chapter" data-level="4.2.1" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#if...else-and-ifelse-statments"><i class="fa fa-check"></i><b>4.2.1</b> <code>if...else</code> and <code>ifelse</code> statments</a></li>
<li class="chapter" data-level="4.2.2" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#for-and-while-loops"><i class="fa fa-check"></i><b>4.2.2</b> <code>for</code> and <code>while</code> loops</a></li>
<li class="chapter" data-level="4.2.3" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#apply-function-family"><i class="fa fa-check"></i><b>4.2.3</b> <code>apply</code> function family</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#operation-on-vectors"><i class="fa fa-check"></i><b>4.3</b> Operation on Vectors</a></li>
<li class="chapter" data-level="4.4" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#randomization-and-distribution"><i class="fa fa-check"></i><b>4.4</b> Randomization and distribution</a></li>
<li class="chapter" data-level="4.5" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#tidyverse-idea-and-dplyr-library"><i class="fa fa-check"></i><b>4.5</b> <code>tidyverse</code> idea and <code>dplyr</code> library</a><ul>
<li class="chapter" data-level="4.5.1" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#wide-vs.long-tables"><i class="fa fa-check"></i><b>4.5.1</b> Wide vs. long tables</a></li>
<li class="chapter" data-level="4.5.2" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#world-of-dplyr"><i class="fa fa-check"></i><b>4.5.2</b> World of <code>dplyr</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#select-columns-and-filter-rows"><i class="fa fa-check"></i><b>4.5.3</b> <code>select</code> columns and <code>filter</code> rows</a></li>
<li class="chapter" data-level="4.5.4" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#mutate-and-transmute"><i class="fa fa-check"></i><b>4.5.4</b> <code>mutate</code> and <code>transmute</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#group_by-and-summarise"><i class="fa fa-check"></i><b>4.5.5</b> <code>group_by</code> and <code>summarise</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="somwehere-between-basic-and-useful.html"><a href="somwehere-between-basic-and-useful.html#is-there-anything-more-in-dplyr-library"><i class="fa fa-check"></i><b>4.6</b> Is there anything more in <code>dplyr</code> library?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html"><i class="fa fa-check"></i><b>5</b> Lets do some math!</a><ul>
<li class="chapter" data-level="5.1" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#models"><i class="fa fa-check"></i><b>5.1</b> Models</a></li>
<li class="chapter" data-level="5.2" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#packages"><i class="fa fa-check"></i><b>5.2</b> Packages</a></li>
<li class="chapter" data-level="5.3" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#simple-mechanistic-model-and-noise"><i class="fa fa-check"></i><b>5.3</b> Simple mechanistic model and noise</a></li>
<li class="chapter" data-level="5.4" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#solving-differential-equations"><i class="fa fa-check"></i><b>5.4</b> Solving differential equations</a><ul>
<li class="chapter" data-level="5.4.1" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#the-simple-epidemiological"><i class="fa fa-check"></i><b>5.4.1</b> The simple epidemiological</a></li>
<li class="chapter" data-level="5.4.2" data-path="lets-do-some-math.html"><a href="lets-do-some-math.html#ploting-seri-model"><i class="fa fa-check"></i><b>5.4.2</b> Ploting SERI model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="funcs.html"><a href="funcs.html"><i class="fa fa-check"></i><b>6</b> Functions</a><ul>
<li class="chapter" data-level="6.1" data-path="funcs.html"><a href="funcs.html#simple-math-functions."><i class="fa fa-check"></i><b>6.1</b> Simple math functions.</a></li>
<li class="chapter" data-level="6.2" data-path="funcs.html"><a href="funcs.html#building-your-own-calculator"><i class="fa fa-check"></i><b>6.2</b> Building your own calculator</a></li>
<li class="chapter" data-level="6.3" data-path="funcs.html"><a href="funcs.html#it-is-not-over-yet-calculator-shouldnt-divide-be-0"><i class="fa fa-check"></i><b>6.3</b> It is not over yet… <em>Calculator shouldn’t divide be 0</em>!</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>7</b> Graphics</a><ul>
<li class="chapter" data-level="7.1" data-path="graphs.html"><a href="graphs.html#base-plots"><i class="fa fa-check"></i><b>7.1</b> Base plots</a></li>
<li class="chapter" data-level="7.2" data-path="graphs.html"><a href="graphs.html#how-to-make-plot"><i class="fa fa-check"></i><b>7.2</b> How to make plot?</a></li>
<li class="chapter" data-level="7.3" data-path="graphs.html"><a href="graphs.html#can-we-actually-do-something"><i class="fa fa-check"></i><b>7.3</b> Can we actually do something?</a></li>
<li class="chapter" data-level="7.4" data-path="graphs.html"><a href="graphs.html#ggplot2---graphics-taken-into-other-dimension"><i class="fa fa-check"></i><b>7.4</b> <code>ggplot2</code> - Graphics taken into other dimension</a><ul>
<li class="chapter" data-level="7.4.1" data-path="graphs.html"><a href="graphs.html#basic-plot-in-ggplot2"><i class="fa fa-check"></i><b>7.4.1</b> Basic plot in <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.4.2" data-path="graphs.html"><a href="graphs.html#density-plots"><i class="fa fa-check"></i><b>7.4.2</b> Density plots</a></li>
<li class="chapter" data-level="7.4.3" data-path="graphs.html"><a href="graphs.html#box-plot-and-bar-plot"><i class="fa fa-check"></i><b>7.4.3</b> Box-plot and bar-plot</a></li>
<li class="chapter" data-level="7.4.4" data-path="graphs.html"><a href="graphs.html#regression"><i class="fa fa-check"></i><b>7.4.4</b> Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simple-workflow.html"><a href="simple-workflow.html"><i class="fa fa-check"></i><b>8</b> Simple workflow</a><ul>
<li class="chapter" data-level="8.1" data-path="simple-workflow.html"><a href="simple-workflow.html#data"><i class="fa fa-check"></i><b>8.1</b> Data</a></li>
<li class="chapter" data-level="8.2" data-path="simple-workflow.html"><a href="simple-workflow.html#exploaratory-visualisation-and-setup"><i class="fa fa-check"></i><b>8.2</b> Exploaratory visualisation and setup</a></li>
<li class="chapter" data-level="8.3" data-path="simple-workflow.html"><a href="simple-workflow.html#growth-models"><i class="fa fa-check"></i><b>8.3</b> Growth models</a></li>
<li class="chapter" data-level="8.4" data-path="simple-workflow.html"><a href="simple-workflow.html#going-further"><i class="fa fa-check"></i><b>8.4</b> Going further</a></li>
<li class="chapter" data-level="8.5" data-path="simple-workflow.html"><a href="simple-workflow.html#copy-paste-data-set"><i class="fa fa-check"></i><b>8.5</b> Copy-paste data set</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="finalindications.html"><a href="finalindications.html"><i class="fa fa-check"></i><b>9</b> Final indications</a><ul>
<li class="chapter" data-level="9.1" data-path="finalindications.html"><a href="finalindications.html#use-projects"><i class="fa fa-check"></i><b>9.1</b> Use Projects</a></li>
<li class="chapter" data-level="9.2" data-path="finalindications.html"><a href="finalindications.html#use-rmarkdown"><i class="fa fa-check"></i><b>9.2</b> Use RMarkdown</a></li>
<li class="chapter" data-level="9.3" data-path="finalindications.html"><a href="finalindications.html#use-.rds-files"><i class="fa fa-check"></i><b>9.3</b> Use .rds files</a></li>
<li class="chapter" data-level="9.4" data-path="finalindications.html"><a href="finalindications.html#nice-resources-you-should-read"><i class="fa fa-check"></i><b>9.4</b> Nice resources you SHOULD read</a></li>
<li class="chapter" data-level="9.5" data-path="finalindications.html"><a href="finalindications.html#solving-problems"><i class="fa fa-check"></i><b>9.5</b> Solving problems</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Beginners Guide to R’s Galaxy</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="somwehere-between-basic-and-useful" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Somwehere between basic and useful</h1>
<div id="addressing" class="section level2">
<h2><span class="header-section-number">4.1</span> Addressing</h2>
<div id="vectors" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Vectors</h3>
<p>When you deal with variables you often will want to use only a part of it in your work. Other times you will want to get rid of some values which follow certain criteria. In order to do it you need to know an ‘address’ of particular value in a <em>vector</em>, <em>data frame</em>, <em>list</em> etc. From now on, I will use some functions while describing it <em>at hoc</em>, since I believe the best way to learn them, is to use them. Lets create a <em>vector</em> and see what we can do with it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">20</span>, <span class="dt">by =</span> <span class="dv">2</span>)
addressVec</code></pre></div>
<pre><code>##  [1]  1  3  5  7  9 11 13 15 17 19</code></pre>
<p>Instead of typing all the numbers by hand, we can use <code>seq()</code> function, to generate it automatically. This function takes two arguments <code>from</code> and <code>to</code>, however additionally we can use option <code>by</code> which defines increment of the sequence. As your knowledge is growing I can tell you a secret. Often, there is no need to name all the arguments and options in functions body. In the beginning you should use the names, but the more experienced you get, you will notice that you omit them often. Actually we nearly always omit so called <em>default</em> options of a function. Use <code>?seq</code> to check the help page for this function. You will see that it can take more options than <code>from</code>, <code>to</code> and <code>by</code>, but since they are predefined we don’t need to bother and type them (as long as we are OK with <em>default</em> settings). So, lets retype our <em>variable</em> definition:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">2</span>)
addressVec</code></pre></div>
<pre><code>##  [1]  1  3  5  7  9 11 13 15 17 19</code></pre>
<p>The results are identical. Lets get back to addressing issues. Suppose you want to check the fifth element of our <code>addressVec</code> variable. To do it we use variable name followed by element number in brackets (or square brackets, if you will).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec[<span class="dv">5</span>]</code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>If you want to get rid of fifth element just precede it with <code>-</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec[<span class="op">-</span><span class="dv">5</span>]</code></pre></div>
<pre><code>## [1]  1  3  5  7 11 13 15 17 19</code></pre>
<p>Easy. The thing that is worth to mention right now is that <strong>R Core Team</strong> have reason and dignity of human beings so they start numeration of elements with value 1. In some other languages, because of no sensible reasons, numeration starts with 0 – which is horribly annoying. What to do if we want to extract values of more than one element?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec[<span class="dv">1</span>,<span class="dv">5</span>]</code></pre></div>
<pre><code>## Error in addressVec[1, 5]: incorrect number of dimensions</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">6</span>]</code></pre></div>
<pre><code>## Error in addressVec[-1, -5, -6]: incorrect number of dimensions</code></pre>
<p>Error occurs with warning that there is incorrect number of dimensions. That’s because <em>vectors</em> have only one dimension – length. Within square brackets comma separates dimensions. So when we used command <code>[1,5]</code> we told R to look for value that address is number 1 in first dimension and number 5 in second dimension. To correct the mistake, we need to provide a vector of numbers from first dimension. We can use <code>c()</code> function to create <em>ad hoc vector</em> inside square brackets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)]</code></pre></div>
<pre><code>## [1] 1 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</code></pre></div>
<pre><code>## [1]  3  5  7 13 15 17 19</code></pre>
<p>Now something more complicated. Try to figure out what code below does, and what is the result of <code>which()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressVec[<span class="kw">which</span>(addressVec <span class="op">&gt;=</span><span class="st"> </span><span class="dv">6</span>)] &lt;-<span class="st"> &#39;o..O&#39;</span>
addressVec</code></pre></div>
<pre><code>##  [1] &quot;1&quot;    &quot;3&quot;    &quot;5&quot;    &quot;o..O&quot; &quot;o..O&quot; &quot;o..O&quot; &quot;o..O&quot; &quot;o..O&quot; &quot;o..O&quot; &quot;o..O&quot;</code></pre>
<p>If you have problems, you can think of this example as a composition of actions. First there is expression <code>addressVec &gt;=6</code>, than we use <code>which()</code> function with argument from previous expression. Next the result is passed as an address. Last thing is assignment of new value to…</p>
</div>
<div id="data-frames-and-matrices" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Data frames (and matrices)</h3>
<p>When dealing with <em>data frames</em>, addressing is possible in two ways. First is similar to <em>vector</em> addressing. However, as <em>data frames</em> have two dimensions, you will need to express them like <code>df[1, 2]</code> – which tells <strong>R</strong> to look up the cell in row 1, column 2. But what if you want to check all the cells in particular row or column? Omit the number, but not the coma – like this: <code>df[, 3]</code>. It will display all row values from column 3. And of course you can still use <em>vectors</em> when addressing. This way also works for <em>matrices</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">C1 =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="dt">C2 =</span> <span class="kw">seq</span>(<span class="dv">11</span>,<span class="dv">20</span>), <span class="dt">C3 =</span> <span class="kw">seq</span>(<span class="dv">21</span>,<span class="dv">30</span>))
addressDF[<span class="dv">5</span>, <span class="dv">2</span>]</code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressDF[<span class="dv">6</span>, ]</code></pre></div>
<pre><code>##   C1 C2 C3
## 6  6 16 26</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressDF[<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">7</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</code></pre></div>
<pre><code>##   C1 C2 C3
## 6  6 16 26
## 7  7 17 27</code></pre>
<p>The second option is to use <code>$</code> sign followed with column name (and it works only for <em>data frames</em> and <em>lists</em>). This way, we tell <strong>R</strong> to look in whole column. If we want to display values from particular cells, we put them in brackets after column name, the same way as we do for <em>vectors</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressDF<span class="op">$</span>C2[<span class="dv">5</span>]</code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressDF<span class="op">$</span>C3[<span class="kw">c</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">9</span>)]</code></pre></div>
<pre><code>## [1] 26 27 28 29</code></pre>
<p>When working with <em>matrices</em> you will find a lot of functions that apply to them (check help page for <code>base</code> package). The one you should familiarize with, if you plan on working with <em>matrix</em> operations are:</p>
<ul>
<li><code>dim()</code> – returns dimensions of <em>matrix</em></li>
<li><code>rownames()</code> and <code>colnames()</code> – to specify row and column names</li>
<li><code>cbind()</code> and <code>rbind()</code> – to add columns or rows to a <em>matrix</em> (respectively)</li>
<li><code>lower.tri()</code>, <code>upper.tri()</code> – lower and upper triangular part of <em>matrix</em></li>
<li><code>t()</code> – <em>matrix</em> transposition</li>
<li><code>outer()</code> – outer products of <em>matrix</em></li>
<li><code>rowsums()</code>, <code>rowmeans()</code>. <code>colsums()</code> and <code>colmeans()</code> – tool to calculate sum and mean of rows or columns</li>
<li><code>%*%</code> – <em>matrix</em> multiplication operator (<code>matrixOne %*% matrix2</code>)</li>
<li><code>diag()</code> – diagonals of a <em>matrix</em></li>
</ul>
<p>You can also check <em>help</em> for <code>Matrix</code> package which contains dozens of functions to deal with <em>matrix</em> algebra and <em>matrix</em> transformations.</p>
</div>
<div id="lists" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Lists</h3>
<p>As mentioned before each <em>list</em> element can have different structure. Thus, addressing is kind of a mixture of all above. First you need to address element of your <em>list</em>. You do it with double brackets containing element number following name of variable. You can also use <code>$</code> sign with name of the element. Than you use addressing the same way you address <em>data frames</em>, <em>vectors</em> or <em>matrices</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x1 =</span> <span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>), <span class="dt">x2 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">x3 =</span> <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">nrow =</span> <span class="dv">2</span>))
addressList[[<span class="dv">2</span>]]</code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressList<span class="op">$</span>x2[<span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressList[[<span class="dv">3</span>]]</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addressList[[<span class="dv">3</span>]][, <span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] 5 6</code></pre>
<p>OK, now simple task for you. There is a function called <code>colnames()</code> which allow us to change names in <em>matrix</em> variable. To use it you need to put name of <em>matrix</em> variable in the parentheses (like this: <code>colnames(x)</code>), and assign value to it (e.g. <code>colnames(x) &lt;- c('one', 'two')). Now change names of of columns in *matrix* that is element of list above to</code>I`, ‘Love’, ‘R’.</p>
</div>
</div>
<div id="control-flow" class="section level2">
<h2><span class="header-section-number">4.2</span> Control flow</h2>
<p>Controlling flow of function, script or whole program is the essence of programming. In general we can divide procedures in two big categories: <strong>conditional control</strong> and <strong>iteration control</strong>. In the first category we will find <code>if...else</code> statements. They change execution of code depending on state of input or previous results. In the second category we will find tools to repeatedly do execute some code. Typically tools to control repeating of code are <code>for</code> and <code>while</code> loops. However, in R there are special functions, which are basically <code>for</code> loops but have slightly better performance, and are shorter to write. We call them <code>apply</code> functions family.</p>
<div id="if...else-and-ifelse-statments" class="section level3">
<h3><span class="header-section-number">4.2.1</span> <code>if...else</code> and <code>ifelse</code> statments</h3>
<p>The simplest way to control how the code is executed are conditions. In an abstract form it is something like telling your machine: if the state is red make it blue, else make it green. The most general form it is written like below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (x) { <span class="co">#writting just X without any condtition is evaluated as x == TRUE</span>
  <span class="cf">function</span>(x)
}
####rest of the code####

<span class="co">#Or...</span>
<span class="cf">if</span> (x) {
  <span class="cf">function</span>(x)
} <span class="cf">else</span> { <span class="co">#in this example this block will be evaluated if x == FALSE</span>
  <span class="cf">function</span>(y)
}</code></pre></div>
<p>As you see, writing conditionals in their basic form is quite easy. If our script can be in just on of two different states while it start evaluating conditions both of above examples will be suitable. In practice it happens quite often that we need to plan different actions because of dichotomy in the results of previous actions. If our code in this place is going to make some simple things you can consider using <code>ifelse()</code> shortcut. It works like below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coinToss &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">3</span>, <span class="dt">replace =</span> T)
coinToss</code></pre></div>
<pre><code>## [1] 1 1 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ifelse</span>(coinToss <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&#39;Win!&#39;</span>, <span class="st">&#39;Looser!&#39;</span>)</code></pre></div>
<pre><code>## [1] &quot;Win!&quot; &quot;Win!&quot; &quot;Win!&quot;</code></pre>
<p>But what if your script can have more than two states when you start evaluating conditions? You will need to use <code>else if()</code> structure. A simple example is below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coinToss &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">3</span>, <span class="dt">replace =</span> T)
sumOfCoins &lt;-<span class="st"> </span><span class="kw">sum</span>(coinToss)<span class="co"># we can have four states here 0,1,2,3</span>
sumOfCoins</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (sumOfCoins <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {
  <span class="st">&#39;Looser&#39;</span>
} <span class="cf">else</span> <span class="cf">if</span> (sumOfCoins <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {
  <span class="st">&#39;Barely alive&#39;</span>
} <span class="cf">else</span> <span class="cf">if</span> (sumOfCoins <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>) {
  <span class="st">&#39;Big Winner!!!&#39;</span>
}</code></pre></div>
<pre><code>## [1] &quot;Barely alive&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Or because the functions realting to particular conditions are simple, you</span>
<span class="co">#can make nested ifelse</span>
<span class="kw">ifelse</span>(<span class="kw">sum</span>(sumOfCoins) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&#39;Looser&#39;</span>,
       <span class="kw">ifelse</span>(<span class="kw">sum</span>(sumOfCoins) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&#39;Barely alive&#39;</span>, <span class="st">&#39;Big Winner!!!&#39;</span>))</code></pre></div>
<pre><code>## [1] &quot;Barely alive&quot;</code></pre>
</div>
<div id="for-and-while-loops" class="section level3">
<h3><span class="header-section-number">4.2.2</span> <code>for</code> and <code>while</code> loops</h3>
<p>In many cases we want to use the same function over data stored in different <em>vectors</em>, columns or data sets. Other time we need to make sequence of computations in which every result depends on the previous one (like, for instance, in <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci sequence</a>). In yet another situation we need to run function over data set, but only till we reach specific value. Of course, we can do everything manually, by copy-pasting code, taping <em>ctrl+enter</em> several times and so on. In every programming language we will find tools that help us automatize this procedures, and by side effect make them less prone to error. Those are called loops. Namely, the most common loops used are <code>for</code> and <code>while</code>. The difference between them, is that in first one we define number of iterations and in the second one we define condition that must be met so the loops is executed. In other words <code>for (i in 1:10) {x + i}</code> means that numbers from 1 to 10 will be added to x in a sequence. <code>while (x &lt; 5) {print(x &lt;- x - 1)}</code> on the other hand will subtract value <code>1</code> from <code>x</code> as long as <code>x</code> is greater than <code>0</code>. You thing that is worth to mention is that <code>while</code> loops are general form and <code>for</code> loops are special cases. It means that it is possible to rewrite any <code>for</code> loop into <code>while</code> loop, but not the other way.</p>
<p>Also when working in loops you should always preallocate memory for your output. In simple words it means, that if you are writing loop, that grows the vector instead of just substitute values, <strong>R</strong> needs to copy your previous results in each iteration. Thus making a <em>vector</em> of length of your number of iterations (or a <em>list</em>) before you start a loop will save you some computational time.</p>
<p>To illustrate how it works in practice lets look on some simple examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exampleDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">norm =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="fl">1.5</span>),
                        <span class="dt">chisq =</span> <span class="kw">rchisq</span>(<span class="dv">100</span>, <span class="dv">3</span>),
                        <span class="dt">pois =</span> <span class="kw">rpois</span>(<span class="dv">100</span>, <span class="fl">3.33</span>))
distroMeans &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&#39;list&#39;</span>, <span class="kw">length</span>(exampleDF)) <span class="co">#prealocate space</span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(exampleDF)) {
  distroMeans[[i]] &lt;-<span class="st"> </span><span class="kw">summary</span>(exampleDF[[i]])
}

distroMeans</code></pre></div>
<pre><code>## [[1]]
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.449   4.176   5.097   5.081   6.180   8.018 
## 
## [[2]]
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2332  1.4592  2.3007  3.4512  4.3316 15.3055 
## 
## [[3]]
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00    1.00    3.00    2.83    4.00    8.00</code></pre>
<p>Above example is very simple, and actually can be made without loop. Try to call from your console following command <code>summary(exampleDF)</code>. This is called vectorization which will be explained few paragraphs below.</p>
<p>But lets get back to loops and write something that might be useful (yet very simple). Assume that you are investigating animals reproduction. You have a herd that counts 60 animals. The reproduction factor is <code>1.34</code>, and survival factor is ‘0.75’. So the overall growth factor can be calculated as <em>reproduction factor</em> * <em>survival factor</em>. In each generation there is some noise in reproduction, i.e. from -3 to 2 animals are born with equal probability. This means, that number of animals in each generation directly depends of the outcome of previous generation. We want to make a chart (Fig. <a href="somwehere-between-basic-and-useful.html#fig:popPlot">4.1</a>) to visualize population dynamics in <code>100</code> generation, thus we decide to use <code>while (time &lt; 101)</code> loop.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#define initial parameters</span>
N_<span class="dv">0</span>   &lt;-<span class="st"> </span><span class="dv">100</span>
rf    &lt;-<span class="st"> </span><span class="fl">1.34</span>
sf    &lt;-<span class="st"> </span><span class="fl">0.75</span>
gf    &lt;-<span class="st"> </span>rf<span class="op">*</span>sf
n_gen &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">101</span>
<span class="co">#we could repeat this inside loop, however we know the number of iterations</span>
<span class="co">#thus calculating noise vector outside loop is better for performance</span>
noise &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="op">-</span><span class="dv">3</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">100</span>, <span class="dt">replace =</span> T)
t &lt;-<span class="st"> </span><span class="dv">1</span>
geners &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&#39;integer&#39;</span>, <span class="dt">length =</span> <span class="kw">length</span>(n_gen))
geners[<span class="dv">1</span>] &lt;-<span class="st"> </span>N_<span class="dv">0</span>
<span class="cf">while</span> (t <span class="op">&lt;</span><span class="st"> </span><span class="dv">101</span>) {
  geners[<span class="kw">c</span>(t <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)] &lt;-<span class="st"> </span><span class="kw">floor</span>((geners[t] <span class="op">*</span><span class="st"> </span>gf <span class="op">+</span><span class="st"> </span>noise[t]))
  t &lt;-<span class="st"> </span>t <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
}

<span class="kw">plot</span>(n_gen, geners, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>,
     <span class="dt">main =</span> <span class="st">&#39;Population dynamics&#39;</span>,
     <span class="dt">xlab =</span> <span class="st">&#39;generation&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;number of animals&#39;</span>,
     <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre></div>
<div class="figure"><span id="fig:popPlot"></span>
<img src="BeginnersGuideToGalaxy_files/figure-html/popPlot-1.png" alt="Population dynamics" width="672" />
<p class="caption">
Figure 4.1: Population dynamics
</p>
</div>
<p>It appears that we found a way to make a species extinct…</p>
</div>
<div id="apply-function-family" class="section level3">
<h3><span class="header-section-number">4.2.3</span> <code>apply</code> function family</h3>
<p>For simple loops there is a shortcut. Namely, there is an <code>apply</code> function family that performs defined function over vector, list, matrix etc. Probably your need to use it will be reduced to <code>lapply()</code> and <code>sapply()</code> function in the beginning, thus I will focus on them here. From my experience it is better to first understand and correctly use <code>for</code> and <code>while</code> loops, than switch to <code>lapply()</code> and <code>sapply()</code> and than learn how to correctly use functions like <code>tapply()</code>, <code>mapply()</code>, <code>vapply()</code>. <code>sapply()</code> generally is the same as <code>lapply()</code>, the only difference is that the later function results in <em>list</em> of the same length as first argument. Each element of list contains results of function that was applied to the first argument. Simplified version tries to simplify results to <em>vector</em>, <em>matrix</em> or <em>array</em>. One tricky thing is that we we want to use function that takes more arguments than just our arguments of values over which we want to iterate we need to use a bit different syntax. In general, lets say our list is named as <code>X</code>, our function is <code>SomeFunction</code>, which takes arguments <code>A</code> and <code>B</code> (<code>SomeFunction(A, B)). Lets asume that each element of</code>X<code>is used as an argument</code>B<code>in consequent iterations, while</code>A<code>is fixed and equals</code>10<code>. The correct for of using lapply (or sapply) will be:</code>lapply(X, SomeFunction, A = 10)`.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">testApply  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">b =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>), <span class="dt">times =</span> <span class="dv">5</span>), <span class="dt">c =</span> <span class="kw">rpois</span>(<span class="dv">5</span>, <span class="dv">25</span>))
testLapply &lt;-<span class="st"> </span><span class="kw">lapply</span>(testApply, mean)
testSapply &lt;-<span class="st"> </span><span class="kw">sapply</span>(testApply, mean)

<span class="co">#Here we combine previous results with another lapply,</span>
<span class="co">#and use function with multiple arguments.</span>
<span class="kw">lapply</span>(testSapply, rpois, <span class="dt">n =</span> <span class="dv">15</span>)</code></pre></div>
<pre><code>## $x
##  [1] 7 5 6 5 3 3 5 3 3 5 2 4 7 5 6
## 
## $b
##  [1] 2 4 5 2 3 4 3 8 6 4 8 3 3 3 5
## 
## $c
##  [1] 29 28 23 28 19 30 21 15 33 31 29 20 27 26 28</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">sapply</span>(testSapply, rpois, <span class="dt">n =</span> <span class="dv">15</span>))</code></pre></div>
<pre><code>##      x b  c
## [1,] 7 3 24
## [2,] 5 5 25
## [3,] 6 2 26
## [4,] 7 2 28
## [5,] 4 0 24
## [6,] 5 5 31</code></pre>
<p>It is also possible to use so called anonymous functions (simplifying – function that does not have name and exists temporally) as an argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">testApplyFun &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>
<span class="kw">lapply</span>(testApplyFun, <span class="cf">function</span>(x) x <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [[1]]
## [1] 1.5
## 
## [[2]]
## [1] 2.5
## 
## [[3]]
## [1] 3.5
## 
## [[4]]
## [1] 4.5
## 
## [[5]]
## [1] 5.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(testApplyFun, <span class="cf">function</span>(x) x <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 1.5 2.5 3.5 4.5 5.5</code></pre>
<p>On the basis of previous code that calculated population dynamics, we can write general function and use it with <code>lappy()</code> to estimate different population dynamics depending on initial population size. Than, by addition of consequent lines representing populations with different starting points we create plot for all 4 populations (Fig. <a href="somwehere-between-basic-and-useful.html#fig:lapplyPopPlot">4.2</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">popDyn &lt;-<span class="st"> </span><span class="cf">function</span>(N_<span class="dv">0</span>, <span class="dt">rf =</span> <span class="fl">1.34</span>, <span class="dt">sf =</span> <span class="fl">0.75</span>, n_gen) {
  gf    &lt;-<span class="st"> </span>rf<span class="op">*</span>sf
  noise &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="op">-</span><span class="dv">3</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">100</span>, <span class="dt">replace =</span> T)
  t &lt;-<span class="st"> </span><span class="dv">1</span>
  geners &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&#39;integer&#39;</span>, <span class="dt">length =</span> n_gen)
  geners[<span class="dv">1</span>] &lt;-<span class="st"> </span>N_<span class="dv">0</span>
  <span class="cf">while</span> (t <span class="op">&lt;</span><span class="st"> </span><span class="dv">101</span>) {
  geners[<span class="kw">c</span>(t <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)] &lt;-<span class="st"> </span><span class="kw">floor</span>((geners[t] <span class="op">*</span><span class="st"> </span>gf <span class="op">+</span><span class="st"> </span>noise[t]))
  t &lt;-<span class="st"> </span>t <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  }
  <span class="kw">return</span>(geners)
}

N_<span class="dv">0</span>   &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>)
popSizes &lt;-<span class="st"> </span><span class="kw">lapply</span>(N_<span class="dv">0</span>, popDyn, <span class="dt">n_gen =</span> <span class="dv">101</span>)

n_gen =<span class="st"> </span><span class="dv">101</span>
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n_gen, popSizes[[<span class="dv">5</span>]], <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>,
     <span class="dt">main =</span> <span class="st">&#39;Population dynamics&#39;</span>,
     <span class="dt">xlab =</span> <span class="st">&#39;generation&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;number of animals&#39;</span>,
     <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="kw">max</span>(popSizes[[<span class="dv">5</span>]])))
<span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n_gen, popSizes[[<span class="dv">4</span>]], <span class="dt">col =</span> <span class="st">&#39;green&#39;</span>)
<span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n_gen, popSizes[[<span class="dv">3</span>]], <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)
<span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n_gen, popSizes[[<span class="dv">2</span>]], <span class="dt">col =</span> <span class="st">&#39;yellow&#39;</span>)
<span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n_gen, popSizes[[<span class="dv">1</span>]], <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>)</code></pre></div>
<div class="figure"><span id="fig:lapplyPopPlot"></span>
<img src="BeginnersGuideToGalaxy_files/figure-html/lapplyPopPlot-1.png" alt="Population dynamics with different starting point" width="672" />
<p class="caption">
Figure 4.2: Population dynamics with different starting point
</p>
</div>
</div>
</div>
<div id="operation-on-vectors" class="section level2">
<h2><span class="header-section-number">4.3</span> Operation on Vectors</h2>
<p>Old proverb:</p>
<blockquote>
<p><em>The power of R is vectorization</em></p>
</blockquote>
<p>Indeed, vectorization is one of the most useful features of <strong>R</strong> environment. In short words, many functions are constructed in such a manner, that one can avoid using loops (since, they are often very slow). When you begin your journey with programming, you will probably not notice the difference in computation speed between <em>vectorized way</em> and <em>loop way</em>. Nonetheless, what will you find attractive, is that in many cases writing in vectorized form feels more natural. So how it works? Most basic functions are <em>written and compiled</em> in very fast, low level languages like <strong>C</strong> or <strong>FORTRAN</strong>. It makes computation way faster, but still we use easy <strong>R</strong> syntax. Instead of running the <em>precompiled</em> function on each of the elements of vector we actually can pass the vector into function – and <strong>R</strong> will know what to do. The speed is achieved because when we use function on each element, <strong>R</strong> needs to figure out what to do several (or even hundred or thousands of) times. However, when we pass whole vector into function, it needs to find out what to do only once. Sometimes, we need to use some other functions, which are not meant to process vectors (or you want to use some arbitrary functions on <em>matrix</em>, <em>data frame</em> or <em>list</em>). In those cases you will need to parse your data more than once to function. In <strong>R</strong> you can do it by using loops or by using so called <code>apply</code> family functions. When I was learning <strong>R</strong> it was most confusing thing to me, however once you get it, they become fairly easy to use. The most important difference for you as a beginner is that when using loops, you should make some memory allocation – in human language, before you run loop, you should create vector which will store results. The loops achieve highest speed when your vector can fit all the values from loop. If you do not know how big your vector will be, you need to relay on <strong>R</strong> ability to re-allocate the memory, which is <strong>S L O W</strong>. <code>apply</code> family hopefully takes care of this problem, so every time you know how to – use it. It will save you time and frustration of using loops. I will cover basic use of this functions later on examples.</p>
</div>
<div id="randomization-and-distribution" class="section level2">
<h2><span class="header-section-number">4.4</span> Randomization and distribution</h2>
<p>Random sampling is quite easy task. There is nice <code>sample()</code> function, that allow you to do that. You can sample from <em>numeric</em>, <em>integer</em> or even <em>character</em> <em>vectors</em>. You can even assign probabilities to particular elements of vector (we will not need that at the moment). So lets make some fun and make virtual casino. We will take two dice and will roll it 1000 times. If the sum of each result is odd and smaller than <code>5</code> we will earn 30EUR. If it is odd and higher than <code>5</code>, we will get 50EUR. However if the sum is even number we loose 70EUR. Lets see if we can beat casino… First lets define our dice and rolls.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">niceDice &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>)
rollDiceOne &lt;-<span class="st"> </span><span class="kw">sample</span>(niceDice, <span class="dv">1000</span>, <span class="dt">replace =</span> T)
rollDiceTwo &lt;-<span class="st"> </span><span class="kw">sample</span>(niceDice, <span class="dv">1000</span>, <span class="dt">replace =</span> T)</code></pre></div>
<p>OK, you heard about power of vectorization already, so lets sum up both vectors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sumDiceRolls &lt;-<span class="st"> </span>rollDiceOne <span class="op">+</span><span class="st"> </span>rollDiceTwo</code></pre></div>
<p>Next lets make some use of knowledge we got and substitute our results with some cash…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cashDiceRolls &lt;-<span class="st"> </span>sumDiceRolls
cashDiceRolls[<span class="kw">which</span>(cashDiceRolls <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>cashDiceRolls <span class="op">&lt;=</span><span class="st"> </span><span class="dv">5</span>)] &lt;-<span class="st"> </span><span class="dv">30</span>
cashDiceRolls[<span class="kw">which</span>(cashDiceRolls <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>cashDiceRolls <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>)] &lt;-<span class="st"> </span><span class="dv">50</span>
cashDiceRolls[<span class="kw">which</span>(cashDiceRolls <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)] &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">70</span>
<span class="kw">sum</span>(cashDiceRolls)</code></pre></div>
<pre><code>## [1] -70000</code></pre>
<p>OK. What happened? We put our substitutions in very wrong order… After first two substitutions we have only even numbers in our vector… So how to fix it? Start with assigning the highest absolute value, and after all change it to negative one.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cashDiceRolls &lt;-<span class="st"> </span>sumDiceRolls
cashDiceRolls[<span class="kw">which</span>(cashDiceRolls <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)] &lt;-<span class="st"> </span><span class="dv">70</span>
cashDiceRolls[<span class="kw">which</span>(cashDiceRolls <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>cashDiceRolls <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>)] &lt;-<span class="st"> </span><span class="dv">50</span>
cashDiceRolls[<span class="kw">which</span>(cashDiceRolls <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>cashDiceRolls <span class="op">&lt;=</span><span class="st"> </span><span class="dv">5</span>)] &lt;-<span class="st"> </span><span class="dv">30</span>
cashDiceRolls[<span class="kw">which</span>(cashDiceRolls  <span class="op">==</span><span class="st"> </span><span class="dv">70</span>)] &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">70</span>
<span class="kw">sum</span>(cashDiceRolls)</code></pre></div>
<pre><code>## [1] -15100</code></pre>
<p>Now, that’s not very nice… We lost a lot of cash… But we can also track how our luck changed. Maybe we were above <code>0</code> for a while, before things got South? Or maybe we were doomed since the beginning? Lets make a plot (Fig. <a href="somwehere-between-basic-and-useful.html#fig:betaDensity-plot">4.4</a>) to evaluate our progress.</p>
<div class="figure" style="text-align: center"><span id="fig:cassino-plot"></span>
<img src="BeginnersGuideToGalaxy_files/figure-html/cassino-plot-1.png" alt="How to lose cash in casino" width="60%" />
<p class="caption">
Figure 4.3: How to lose cash in casino
</p>
</div>
<p>I think that your love to <strong>R</strong> is being deeper since I showed you how it can save a lot of your money!</p>
<p>In nowadays stochastic analyses are more, and more popular. With <strong>R</strong> it is quite easy to generate random numbers, sample and do all the <em>mumbo jumbo</em> on data. There are few functions that cover <em>classical</em> distributions: normal, Poisson, binomial, uniform (and few others), that are actually build in base <strong>R</strong> distribution (full list you will find <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Distributions.html">here</a>). Some more sophisticated stuff is usually covered by some packages you will need to download by yourself. You will easily find them by querying Google like this <a href="https://www.google.com/search?client=ubuntu&amp;channel=fs&amp;q=Pearson+distribution+in+R&amp;ie=utf-8&amp;oe=utf-8&amp;gfe_rd=cr&amp;dcr=0&amp;ei=KTI5Ws_7LfPBXrSBr7gO">Pearson distribution in R</a>. By using this technique it is also possible to find other useful packages for dealing with distributions (try to search for package that allows you to sample from trimmed distribution). All the distribution packages follow the same schema when naming functions. They use letters: <code>d</code>, <code>p</code>, <code>q</code> and <code>r</code> followed by abbreviation of distribution name to generate: density, distribution function, quantile function and random numbers – respectively. For instance, lets generate ten random numbers from <em>beta distribution</em>, with parameters <code>10</code> and <code>3</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rbeta</span>(<span class="dv">25</span>, <span class="dv">10</span>, <span class="dv">3</span>)</code></pre></div>
<pre><code>##  [1] 0.7908879 0.9171753 0.7280275 0.9221093 0.7252771 0.8567831 0.8486032
##  [8] 0.7670714 0.7885699 0.8840273 0.7754467 0.8560377 0.9254879 0.8793097
## [15] 0.7833065 0.9271284 0.7599927 0.8210341 0.5326531 0.8575099 0.8874445
## [22] 0.8617398 0.7338219 0.8352085 0.6764179</code></pre>
<p>Or we can make this nice plot (Fig. <a href="somwehere-between-basic-and-useful.html#fig:betaDensity-plot">4.4</a>) for density of <em>beta distribution</em> with parameters <code>8</code> and <code>3</code>:</p>
<div class="figure" style="text-align: center"><span id="fig:betaDensity-plot"></span>
<img src="BeginnersGuideToGalaxy_files/figure-html/betaDensity-plot-1.png" alt="Example of beta distribution" width="60%" />
<p class="caption">
Figure 4.4: Example of beta distribution
</p>
</div>
</div>
<div id="tidyverse-idea-and-dplyr-library" class="section level2">
<h2><span class="header-section-number">4.5</span> <code>tidyverse</code> idea and <code>dplyr</code> library</h2>
<p>The whole idea of tidy data comes from one of most famous <strong>R</strong> developers – <a href="http://hadley.nz/">Hadley Wickham</a>. In on of his papers <span class="citation">(Wickham <a href="#ref-hadley2014">2014</a>)</span> he described procedures for generating and cleaning data in standardized manner. Many packages right now are designed to work best with data structured according to this publication. Eventually it lead to <code>tidiverse</code> – tools tailored for data science with common syntax and philosophy <span class="citation">(Wickham <a href="#ref-R-tidyverse">2017</a>)</span>. One of the most useful packages that are included in <code>tidiverse</code> <span class="citation">(Wickham <a href="#ref-R-tidyverse">2017</a>)</span> are <code>tidyr</code> <span class="citation">(Wickham and Henry <a href="#ref-R-tidyr">2018</a>)</span> and <code>dplyr</code> <span class="citation">(Wickham et al. <a href="#ref-R-dplyr">2018</a>)</span>. First helps us to swap from ‘wide’ to ‘long’ table format (and back). The second package contains set of tools to easily manipulate rows, columns or even single cells in <em>data frame</em>. It is extremely powerful tool, which speeds up work with data sets so much, that after few times dealing with it, you will leave traditional spread sheet forever.</p>
<div id="wide-vs.long-tables" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Wide vs. long tables</h3>
<p>Lets start with changing wide format table into long format table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wideTable &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">male =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">female =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">12</span>)
wideTable</code></pre></div>
<pre><code>##    male female
## 1     1      3
## 2     2      4
## 3     3      5
## 4     4      6
## 5     5      7
## 6     6      8
## 7     7      9
## 8     8     10
## 9     9     11
## 10   10     12</code></pre>
<p>Than we just make a little <em>mumbo jumbo</em> and change it to long format:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;tidyr&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;dplyr&#39;</span>)
longTable &lt;-<span class="st"> </span><span class="kw">gather</span>(wideTable, <span class="dt">key =</span> sex, <span class="dt">value =</span> number)
longTable[<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>, ]</code></pre></div>
<pre><code>##       sex number
## 7    male      7
## 8    male      8
## 9    male      9
## 10   male     10
## 11 female      3
## 12 female      4</code></pre>
<p>That is how easy it can be done. But what if table is more complicated?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wideTable2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">male =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,
                         <span class="dt">female =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">12</span>, 
                         <span class="dt">type =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;bacteria&#39;</span>, <span class="st">&#39;virus&#39;</span>), <span class="dt">times =</span> <span class="dv">5</span>),
                         <span class="dt">group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>), <span class="dt">each =</span> <span class="dv">5</span>))
wideTable2</code></pre></div>
<pre><code>##    male female     type group
## 1     1      3 bacteria     a
## 2     2      4    virus     a
## 3     3      5 bacteria     a
## 4     4      6    virus     a
## 5     5      7 bacteria     a
## 6     6      8    virus     b
## 7     7      9 bacteria     b
## 8     8     10    virus     b
## 9     9     11 bacteria     b
## 10   10     12    virus     b</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gather</span>(wideTable2, sex, number, <span class="op">-</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>))[<span class="dv">7</span><span class="op">:</span><span class="dv">13</span>, ]</code></pre></div>
<pre><code>##        type group    sex number
## 7  bacteria     b   male      7
## 8     virus     b   male      8
## 9  bacteria     b   male      9
## 10    virus     b   male     10
## 11 bacteria     a female      3
## 12    virus     a female      4
## 13 bacteria     a female      5</code></pre>
<p>In example above, using expression <code>-(3, 4)</code> we indicated that we do not want to gather columns 3 and 4.</p>
<p>Even more complicated?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wideTable3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">male =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">each =</span> <span class="dv">2</span>),
                         <span class="dt">female =</span> <span class="kw">rep</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">times =</span> <span class="dv">2</span>), 
                         <span class="dt">type =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;bacteria&#39;</span>,<span class="st">&#39;virus&#39;</span>), <span class="dt">times =</span> <span class="dv">10</span>),
                         <span class="dt">group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>), <span class="dt">each =</span> <span class="dv">10</span>),
                         <span class="dt">day =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)
wideTable3[<span class="dv">7</span><span class="op">:</span><span class="dv">13</span>, ]</code></pre></div>
<pre><code>##    male female     type group day
## 7     4      9 bacteria     a   7
## 8     4     10    virus     a   8
## 9     5     11 bacteria     a   9
## 10    5     12    virus     a  10
## 11    6      3 bacteria     b   1
## 12    6      4    virus     b   2
## 13    7      5 bacteria     b   3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gather</span>(wideTable3, sex, number, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spread</span>(group, number) <span class="op">%&gt;%</span><span class="st"> </span>.[<span class="dv">7</span><span class="op">:</span><span class="dv">13</span>, ]</code></pre></div>
<pre><code>##        type day    sex  a  b
## 7  bacteria   7 female  9  9
## 8  bacteria   7   male  4  9
## 9  bacteria   9 female 11 11
## 10 bacteria   9   male  5 10
## 11    virus   2 female  4  4
## 12    virus   2   male  1  6
## 13    virus   4 female  6  6</code></pre>
<p>Here our data set had additional column <code>group</code> storing values <code>a</code> and <code>b</code>. But imagine that <code>group</code> is not a variable, but it just stores the names of variables - which are a and b. This somehow might be frustrating, to decide if those are really separate variables or not. You might run into problem, that your column named <code>environmental factor</code> contains values: <em>pH</em>, <em>conductivity</em>, and <em>oxygen concentration</em>. This would be straightforward as each of this is different variable and you should spread this column into three different variables. On the other hand you might see a column that contains <em>minimum temperature</em> and <em>maximum temperature</em>. This would not be as straightforward and decision upon spreading this column would strongly depend on the context. Nonetheless, using <code>spread()</code> function we were able to transform values from this column as separate columns. We also used <em>piping operator</em> <code>%&gt;%</code>. It is a shortcut, which allows us to pass the left side as an argument to the function on the right side of operator. In general it means that writing <code>a %&gt;% funtion(b)</code> actually is translated into <code>function(a, b)</code>. In the beginning this idea might be not very useful for you, but with time it will get helpful. Mainly because your code gets better structure and you can perform multiple operations without storing it in variables (which you do not want, since it consumes memory).</p>
<p>There is also one more common case that I should shortly mention - compound variable. It is a variable that stores multiple values in a single column. E.g. city and district, age and sex, sex and smoking, blood type and RH, etc. With <code>tidyr</code> is very easy to deal with it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wideTable4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">type =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;bacteria.a&#39;</span>, <span class="st">&#39;virus.a&#39;</span>), <span class="dt">times =</span> <span class="dv">5</span>))
wideTable4</code></pre></div>
<pre><code>##          type
## 1  bacteria.a
## 2     virus.a
## 3  bacteria.a
## 4     virus.a
## 5  bacteria.a
## 6     virus.a
## 7  bacteria.a
## 8     virus.a
## 9  bacteria.a
## 10    virus.a</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wideTable4 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(type, <span class="kw">c</span>(<span class="st">&#39;organism&#39;</span>, <span class="st">&#39;type&#39;</span>), <span class="dt">sep =</span> <span class="st">&#39;</span><span class="ch">\\</span><span class="st">.&#39;</span>)</code></pre></div>
<pre><code>##    organism type
## 1  bacteria    a
## 2     virus    a
## 3  bacteria    a
## 4     virus    a
## 5  bacteria    a
## 6     virus    a
## 7  bacteria    a
## 8     virus    a
## 9  bacteria    a
## 10    virus    a</code></pre>
</div>
<div id="world-of-dplyr" class="section level3">
<h3><span class="header-section-number">4.5.2</span> World of <code>dplyr</code></h3>
<p><code>dplyr</code> is a library containing several useful functions, designed to ease all kinds of transformations, selections and filtering of your data frame. As the number and possibilities of functions are really huge, here I will concentrate only on some mostly used ones. Of course there is a well described documentation if you want to get deeper.</p>
</div>
<div id="select-columns-and-filter-rows" class="section level3">
<h3><span class="header-section-number">4.5.3</span> <code>select</code> columns and <code>filter</code> rows</h3>
<p>Those are the most basic operations on <em>data frames</em>. <code>select()</code> function allows you to choose which columns you use. The biggest advantage of using this function instead of simple addressing, is that you can use some special functions inside it: <code>starts_with(), ends_with(), contains(), matches(), num_range()</code> which are helpful when using large data sets with numerous columns. There is also similar function <code>rename()</code> which can be used to change variable names, but in results (contrary to <code>select()</code>) it keeps all the variables. Lets look how the thing works on some simple examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">select</span>(wideTable3, <span class="kw">starts_with</span>(<span class="st">&#39;gr&#39;</span>)), <span class="dv">3</span>)</code></pre></div>
<pre><code>##   group
## 1     a
## 2     a
## 3     a</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">select</span>(wideTable3, <span class="op">-</span><span class="kw">starts_with</span>(<span class="st">&#39;gr&#39;</span>)), <span class="dv">3</span>)</code></pre></div>
<pre><code>##   male female     type day
## 1    1      3 bacteria   1
## 2    1      4    virus   2
## 3    2      5 bacteria   3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">select</span>(wideTable3, <span class="kw">contains</span>(<span class="st">&#39;ale&#39;</span>)), <span class="dv">3</span>)</code></pre></div>
<pre><code>##   male female
## 1    1      3
## 2    1      4
## 3    2      5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">rename</span>(wideTable3, <span class="dt">Male =</span> male), <span class="dv">3</span>)</code></pre></div>
<pre><code>##   Male female     type group day
## 1    1      3 bacteria     a   1
## 2    1      4    virus     a   2
## 3    2      5 bacteria     a   3</code></pre>
<p>Filtering rows is also straightforward. Inside function <code>filter()</code> you can use logical operators (<code>&amp;, |, xor, !</code>), comparisons (e.g. <code>==</code> or <code>&gt;=</code>), or functions (<code>is.na(), between(), near()</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(wideTable3, group <span class="op">==</span><span class="st"> &#39;a&#39;</span>)</code></pre></div>
<pre><code>##    male female     type group day
## 1     1      3 bacteria     a   1
## 2     1      4    virus     a   2
## 3     2      5 bacteria     a   3
## 4     2      6    virus     a   4
## 5     3      7 bacteria     a   5
## 6     3      8    virus     a   6
## 7     4      9 bacteria     a   7
## 8     4     10    virus     a   8
## 9     5     11 bacteria     a   9
## 10    5     12    virus     a  10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(wideTable3, type <span class="op">!=</span><span class="st"> &#39;bacteria&#39;</span>)</code></pre></div>
<pre><code>##    male female  type group day
## 1     1      4 virus     a   2
## 2     2      6 virus     a   4
## 3     3      8 virus     a   6
## 4     4     10 virus     a   8
## 5     5     12 virus     a  10
## 6     6      4 virus     b   2
## 7     7      6 virus     b   4
## 8     8      8 virus     b   6
## 9     9     10 virus     b   8
## 10   10     12 virus     b  10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(wideTable3, <span class="kw">near</span>(female, <span class="dv">5</span>))</code></pre></div>
<pre><code>##   male female     type group day
## 1    2      5 bacteria     a   3
## 2    7      5 bacteria     b   3</code></pre>
</div>
<div id="mutate-and-transmute" class="section level3">
<h3><span class="header-section-number">4.5.4</span> <code>mutate</code> and <code>transmute</code></h3>
<p>Both functions are widely used in data manipulation in <strong>R</strong>. Their main purpose is to create new variable (usually from existing ones) in data frame. Lets look on examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(wideTable3, male) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cumulativeMaleSum =</span> <span class="kw">cumsum</span>(male)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>##   male cumulativeMaleSum
## 1    1                 1
## 2    1                 2
## 3    2                 4
## 4    2                 6
## 5    3                 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(wideTable3, male, female) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cumulativeMaleSum =</span> <span class="kw">cumsum</span>(male),
         <span class="dt">femaleLog =</span> <span class="kw">log</span>(female),
         <span class="dt">cumSumFemaleLog =</span> <span class="kw">cumsum</span>(femaleLog)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>##   male female cumulativeMaleSum femaleLog cumSumFemaleLog
## 1    1      3                 1  1.098612        1.098612
## 2    1      4                 2  1.386294        2.484907
## 3    2      5                 4  1.609438        4.094345
## 4    2      6                 6  1.791759        5.886104
## 5    3      7                 9  1.945910        7.832014</code></pre>
<p>As you can see in second example, when we use <code>mutate()</code> function, the newly created variables (in this example <code>femaleLog</code>) are available immediately so we can use them to create another variable (in this case <code>cumSumFemaleLog</code>) within one function call. In this example, I also used piping operator, because calculating intermediate steps and storing them as a result, which can be used later is useless, as we are interested only in the final outcome. The biggest advantage of this procedure is that we keep our <em>Environment</em> clean and preserve memory – which is very important in long and memory consuming projects. Last but not least, the difference between <code>mutate()</code> and <code>transmute()</code> is that the latter do not preserve all variables, only the ones you created.</p>
</div>
<div id="group_by-and-summarise" class="section level3">
<h3><span class="header-section-number">4.5.5</span> <code>group_by</code> and <code>summarise</code></h3>
<p><code>summarise()</code> is commonly used function on grouped data. It allows to calculate many typical descriptive statistics (like <code>mean()</code> or <code>quantile()</code>) for particular groups in you data set, as well as it can count number of observations (<code>n()</code> function), or number of unique observations (<code>distinct()</code>). To see how it works in practice lets look back on our example and calculate mean value for <code>males</code> and <code>female</code>, as well as day range and number of cases for groups derived from <code>type</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wideTable3 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(type) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">meanF =</span> <span class="kw">mean</span>(female),
            <span class="dt">meanM =</span> <span class="kw">mean</span>(male),
            <span class="dt">numberOfDays =</span> (<span class="kw">range</span>(day)[<span class="dv">2</span>]<span class="op">-</span><span class="kw">range</span>(day)[<span class="dv">1</span>]),
            <span class="dt">numberOfCases =</span> <span class="kw">n</span>())</code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   type     meanF meanM numberOfDays numberOfCases
##   &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt;        &lt;int&gt;         &lt;int&gt;
## 1 bacteria     7   5.5            8            10
## 2 virus        8   5.5            8            10</code></pre>
<p>Easy.</p>
</div>
</div>
<div id="is-there-anything-more-in-dplyr-library" class="section level2">
<h2><span class="header-section-number">4.6</span> Is there anything more in <code>dplyr</code> library?</h2>
<p>Yes. Actually I presented here only very very tiny fracture of <code>dplyr</code> possibilities just to familiarize you with syntax and using piping operator. When you go deeper into world of data frames transformation, you will find other commonly used functions like: different kinds of joining data frames (similar to <strong>SQL</strong> joining tables), conditional selecting, filtering, renaming rows and columns, extracting values or arranging your data frame. Thankfully this procedures are so common that even if you won’t grasp it immediately from functions description, you will still find hundreds of tutorials on the web, or help in <em>StackOverflow</em>.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-hadley2014">
<p>Wickham, Hadley. 2014. “Tidy Data.” <em>Journal of Statistical Software</em> 59 (10): 1–23.</p>
</div>
<div id="ref-R-tidyverse">
<p>Wickham, Hadley. 2017. <em>Tidyverse: Easily Install and Load the ’Tidyverse’</em>. <a href="https://CRAN.R-project.org/package=tidyverse" class="uri">https://CRAN.R-project.org/package=tidyverse</a>.</p>
</div>
<div id="ref-R-tidyr">
<p>Wickham, Hadley, and Lionel Henry. 2018. <em>Tidyr: Easily Tidy Data with ’Spread()’ and ’Gather()’ Functions</em>. <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a>.</p>
</div>
<div id="ref-R-dplyr">
<p>Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2018. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lets-do-some-math.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["BeginnersGuideToGalaxy.pdf", "BeginnersGuideToGalaxy.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
